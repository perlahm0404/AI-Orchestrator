{
  "project": "credentialmate",
  "sequence": 13,
  "fingerprints": [],
  "features": [
    {
      "id": "TASK-ADR001-002",
      "description": "Add backend dependencies for report generation\n\nUpdate requirements.txt with:\n- reportlab (PDF generation)\n- openpyxl (Excel generation, optional phase 2)\n- celery[redis] (async workers)\n- boto3 (S3 uploads)\nRun pip install to verify compatibility",
      "file": "requirements.txt",
      "status": "complete",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 1,
      "last_attempt": "2026-01-10T14:03:49.510683",
      "completed_at": "2026-01-10T14:03:59.258955",
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 10,
      "verification_verdict": "FAIL",
      "files_actually_changed": [
        "apps/backend-api/src/contexts/cme/constants.py",
        "apps/backend-api/src/core/calculators/cme_compliance_calculator.py",
        "claude-progress.txt",
        "generate_cme_v4.py"
      ],
      "priority": 0,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "manual",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-004",
      "description": "Create Pydantic schemas for report generation\n\nCreate apps/backend-api/app/schemas/reports.py with:\n- ReportGenerateRequest (filters, format, include_sections)\n- ReportJobResponse (job_id, status, progress_percentage, download_url, expires_at)\n- ReportFilters (urgency_levels, date_range, provider_ids)\n- ReportFormat enum (pdf, csv, excel)\n- ReportStatus enum (queued, processing, completed, failed)\nInclude validation logic and examples",
      "file": "apps/backend-api/app/schemas/reports.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-005",
      "description": "Create SQLAlchemy models for report_jobs and report_access_logs\n\nCreate apps/backend-api/app/models/report.py with:\n- ReportJob model (matches schema from migration)\n- ReportAccessLog model (matches schema from migration)\n- Relationship definitions\n- Helper methods: is_expired(), can_download(), mark_accessed()\nEnsure HIPAA-sensitive fields are properly marked",
      "file": "apps/backend-api/app/models/report.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-006",
      "description": "Create report generation API routes\n\nCreate apps/backend-api/app/api/v1/reports/routes.py with:\n- POST /api/v1/reports/at-risk (initiate report)\n- GET /api/v1/reports/jobs/{job_id} (check status)\n- GET /api/v1/reports/jobs (list user's reports)\nInclude:\n- Authentication checks (require provider role)\n- Rate limiting (10 reports/hour per user)\n- HIPAA audit logging for all endpoints\n- Input validation",
      "file": "apps/backend-api/app/api/v1/reports/routes.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-007",
      "description": "Create report service layer with business logic\n\nCreate apps/backend-api/app/services/reports.py with:\n- create_report_job() - Creates DB record, enqueues Celery task\n- get_report_status() - Fetches job status with download URL\n- list_user_reports() - Returns paginated report history\n- generate_signed_url() - Creates time-limited S3 URL (5 min expiry)\n- log_report_access() - HIPAA audit trail\nInclude error handling and transaction management",
      "file": "apps/backend-api/app/services/reports.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-008",
      "description": "Create Celery task for report generation\n\nCreate apps/worker-tasks/tasks/generate_report.py with:\n- generate_at_risk_report() Celery task\n- Query credentials with urgency filters (at_risk, urgent)\n- Stream results in chunks (500 records at a time)\n- Call PDF/CSV builder based on format\n- Upload to S3 with encryption\n- Update job status (processing \u2192 completed/failed)\n- Progress updates via Celery self.update_state()\n- Timeout handling (max 5 minutes)\nEnsure all PHI queries are logged",
      "file": "apps/worker-tasks/tasks/generate_report.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-009",
      "description": "Create PDF report builder\n\nCreate apps/worker-tasks/builders/pdf_builder.py with:\n- build_at_risk_pdf() function\n- ReportLab templates:\n  - Executive summary (counts, urgency breakdown)\n  - Credential details table (name, type, expiry, status)\n  - Action recommendations section\n- Styling: Headers, watermarks ('CONFIDENTIAL - HIPAA PROTECTED')\n- Color-coded urgency indicators (red=urgent, yellow=at_risk)\n- Page numbers, timestamps, provider info\nStream data to avoid memory issues on large reports",
      "file": "apps/worker-tasks/builders/pdf_builder.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-010",
      "description": "Create CSV report builder\n\nCreate apps/worker-tasks/builders/csv_builder.py with:\n- build_at_risk_csv() function\n- Columns: Provider Name, Credential Type, Credential Number, Issue Date, Expiry Date, Status, Urgency Level, Days Until Expiry, Action Required\n- Include summary header rows (total count, urgency breakdown)\n- Proper CSV escaping for special characters\n- Stream writing for large datasets\nEnsure UTF-8 encoding",
      "file": "apps/worker-tasks/builders/csv_builder.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-011",
      "description": "Create S3 upload utility with encryption\n\nCreate apps/worker-tasks/utils/s3_uploader.py with:\n- upload_report() function\n- KMS encryption enforcement\n- Content-Type headers based on format\n- Content-Disposition: attachment; filename=...\n- Generate S3 key: reports/{user_id}/{job_id}/{filename}\n- Error handling and retries\n- Validate upload success\nEnsure no unencrypted uploads are possible",
      "file": "apps/worker-tasks/utils/s3_uploader.py",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-012",
      "description": "Create React ReportDownloader component\n\nCreate apps/frontend-web/src/components/reports/ReportDownloader.tsx with:\n- Format selector (PDF/CSV radio buttons)\n- Date range picker (start/end dates)\n- Urgency level checkboxes (Urgent, At Risk)\n- Provider selector (if admin, multi-select)\n- 'Generate Report' button\n- Loading state during generation\n- Success/error notifications\n- TypeScript types\n- Accessible form controls (labels, ARIA)\nIntegrate with react-hook-form for validation",
      "file": "apps/frontend-web/src/components/reports/ReportDownloader.tsx",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-013",
      "description": "Create React job status polling hook\n\nCreate apps/frontend-web/src/hooks/useReportJobStatus.ts with:\n- useReportJobStatus(jobId) custom hook\n- Polling logic: fetch status every 2 seconds\n- Stop polling when status = completed/failed\n- Progress percentage display\n- Auto-download when complete (window.location.href = download_url)\n- Cleanup on unmount\n- Error handling and retry logic\nUse react-query for caching and state management",
      "file": "apps/frontend-web/src/hooks/useReportJobStatus.ts",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 1,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-014",
      "description": "Create React ReportHistory component\n\nCreate apps/frontend-web/src/components/reports/ReportHistory.tsx with:\n- Table showing recent reports (last 10)\n- Columns: Report Type, Format, Generated At, Expires At, Status, Actions\n- Re-download button (if not expired)\n- Expiration countdown timer\n- Status badges (completed/failed/processing)\n- Empty state handling\n- Pagination (if needed)\n- TypeScript types\nIntegrate with react-query for data fetching",
      "file": "apps/frontend-web/src/components/reports/ReportHistory.tsx",
      "status": "pending",
      "tests": [],
      "passes": false,
      "error": null,
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "FEATURE_COMPLETE",
      "max_iterations": 50,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 2,
      "bug_count": null,
      "is_new": null,
      "type": "feature",
      "branch": "feature/adr-001-report-generation",
      "agent": "FeatureBuilder",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    },
    {
      "id": "TASK-ADR001-015",
      "description": "Write comprehensive tests for report generation system\n\nCreate test files:\n1. tests/api/test_reports.py - API endpoint tests\n   - Test POST /reports/at-risk with valid/invalid inputs\n   - Test GET /reports/jobs/{id} with different statuses\n   - Test authentication/authorization\n   - Test rate limiting\n2. tests/workers/test_generate_report.py - Celery task tests\n   - Test PDF generation with mock data\n   - Test CSV generation with mock data\n   - Test S3 upload with mocks\n   - Test error handling\n3. tests/integration/test_report_flow.py - End-to-end test\n   - Create job \u2192 poll status \u2192 download report\n   - Verify audit logs created\n   - Verify S3 object exists and is encrypted\nTarget: 90% coverage (L1 requirement)",
      "file": "tests/api/test_reports.py",
      "status": "blocked",
      "tests": [],
      "passes": false,
      "error": "Target file not found: tests/api/test_reports.py",
      "attempts": 0,
      "last_attempt": null,
      "completed_at": null,
      "completion_promise": "TESTS_COMPLETE",
      "max_iterations": 15,
      "verification_verdict": null,
      "files_actually_changed": null,
      "priority": 0,
      "bug_count": null,
      "is_new": null,
      "type": "test",
      "branch": "feature/adr-001-report-generation",
      "agent": "TestWriter",
      "requires_approval": null,
      "source": "ADR-001",
      "discovered_by": "app-advisor",
      "fingerprint": null
    }
  ]
}