# Admin Team Contract
# Version: 1.0
# Part of: AI Team Governance

name: admin-team
version: "1.0"
mode: autonomous
autonomy_level: L2
description: "Contract for Admin agents (ADR Creator, system maintenance)"

applies_to:
  - adr-creator
  - system-admin

# ═══════════════════════════════════════════════════════════════════════════════
# ALLOWED / FORBIDDEN ACTIONS
# ═══════════════════════════════════════════════════════════════════════════════

allowed_actions:
  - action: "read_file"
    description: "Read any file in repository"

  - action: "write_file"
    description: "Write ADR drafts and documentation"
    restrictions:
      - "Only write to AI-Team-Plans/ directory"
      - "Cannot modify application source code"

  - action: "update_adr_registry"
    description: "Update ADR-INDEX.md with new entries"
    restrictions:
      - "Must use atomic file locking"
      - "Must validate entry format"

  - action: "register_tasks"
    description: "Register tasks with work queue"
    restrictions:
      - "Tasks must have valid task_type"
      - "Must include source ADR reference"

  - action: "log_event"
    description: "Log events to events/current/"

  - action: "read_work_queue"
    description: "Read work queue to get task context"

  - action: "update_work_queue"
    description: "Add extracted tasks to work queue"

forbidden_actions:
  - action: "modify_source_code"
    description: "Cannot modify application code"
    message: "Admin agents handle documentation, not code"

  - action: "run_tests"
    description: "Cannot execute test suites"
    message: "Testing is Builders' responsibility"

  - action: "run_commands"
    description: "Cannot execute shell commands"
    message: "Admin agents are documentation-focused"

  - action: "deploy"
    description: "Cannot trigger deployments"
    message: "Deployment requires Operator team"

  - action: "modify_infrastructure"
    description: "Cannot change infra configuration"
    message: "Infrastructure changes need Operator team"

  - action: "approve_adr"
    description: "Cannot approve ADRs"
    message: "ADR approval requires human decision"

  - action: "bypass_registry_lock"
    description: "Cannot bypass file locking"
    message: "Atomic operations are mandatory"

# ═══════════════════════════════════════════════════════════════════════════════
# BEHAVIORS
# ═══════════════════════════════════════════════════════════════════════════════

behaviors:
  # ADR creation requirements
  adr_creation:
    must_reserve_number: true
    must_use_template: true
    must_update_registry: true
    must_extract_tasks: true
    atomic_operations: true

  # Documentation quality
  documentation:
    must_validate_markdown: true
    must_include_metadata: true
    must_link_related_adrs: true
    plain_language_required: true

  # Task extraction
  task_extraction:
    must_validate_format: true
    must_assign_type: true
    must_link_to_adr: true
    must_update_queue: true

# ═══════════════════════════════════════════════════════════════════════════════
# LIMITS
# ═══════════════════════════════════════════════════════════════════════════════

limits:
  max_iterations: 3
  max_retries: 2
  max_adr_length_chars: 10000
  max_tasks_per_adr: 20
  max_concurrent_adrs: 1

# ═══════════════════════════════════════════════════════════════════════════════
# COMPLETION SIGNALS
# ═══════════════════════════════════════════════════════════════════════════════

completion_signals:
  adr_creator: "ADR_CREATE_COMPLETE"

# ═══════════════════════════════════════════════════════════════════════════════
# HALT CONDITIONS
# ═══════════════════════════════════════════════════════════════════════════════

halt_conditions:
  - condition: "work_queue_not_found"
    description: "Cannot locate work queue for project"

  - condition: "adr_context_missing"
    description: "Task missing required adr_context field"

  - condition: "registry_lock_failed"
    description: "Failed to acquire ADR number lock"

  - condition: "template_not_found"
    description: "ADR template file missing"

  - condition: "invalid_task_format"
    description: "Extracted task missing required fields"

on_violation: halt
